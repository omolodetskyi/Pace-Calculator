sergey1313: при первом беглом взгляде могу сказать что не используется magic numbers -fixed
 а в проге их навалом , в контроллере супер длинный метод с дублированием кода , лучше разбить на много мелких приветных методов , код будет более читаемый -fixed
  , пустые строки между строками кода только одна и только тогда когда нужно подчеркнуть что это разные элементы логики!!! - fixed